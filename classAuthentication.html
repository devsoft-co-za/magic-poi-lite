<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Magic Poi Lite: Authentication Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Magic Poi Lite<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">IOT LED Poi</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classAuthentication-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Authentication Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Authentication:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication__coll__graph.png" border="0" usemap="#aAuthentication_coll__map" alt="Collaboration graph"/></div>
<map name="aAuthentication_coll__map" id="aAuthentication_coll__map">
<area shape="rect" title=" " alt="" coords="5,5,188,245"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa9b94b76dacc03be59b8d921acc198f9" id="r_aa9b94b76dacc03be59b8d921acc198f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9b94b76dacc03be59b8d921acc198f9">Authentication</a> ()</td></tr>
<tr class="memdesc:aa9b94b76dacc03be59b8d921acc198f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor for <a class="el" href="classAuthentication.html">Authentication</a> class.  <br /></td></tr>
<tr class="separator:aa9b94b76dacc03be59b8d921acc198f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac67cb64472ed5e95794d07ce9f5e1b86" id="r_ac67cb64472ed5e95794d07ce9f5e1b86"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac67cb64472ed5e95794d07ce9f5e1b86">readJWTTokenFromFile</a> ()</td></tr>
<tr class="memdesc:ac67cb64472ed5e95794d07ce9f5e1b86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads JWT token from a file stored on LittleFS.  <br /></td></tr>
<tr class="separator:ac67cb64472ed5e95794d07ce9f5e1b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a851cf9bcfc0010ecf0d10626312d6f" id="r_a7a851cf9bcfc0010ecf0d10626312d6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a851cf9bcfc0010ecf0d10626312d6f">saveJWTTokenToFile</a> (const char *<a class="el" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>)</td></tr>
<tr class="memdesc:a7a851cf9bcfc0010ecf0d10626312d6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves a JWT token to a file on LittleFS.  <br /></td></tr>
<tr class="separator:a7a851cf9bcfc0010ecf0d10626312d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb33404cd51828edf0db0cdce3c38b32" id="r_aeb33404cd51828edf0db0cdce3c38b32"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb33404cd51828edf0db0cdce3c38b32">authenticate</a> ()</td></tr>
<tr class="memdesc:aeb33404cd51828edf0db0cdce3c38b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authenticates the client with the server.  <br /></td></tr>
<tr class="separator:aeb33404cd51828edf0db0cdce3c38b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e13c5fb0a17675cbe2bf781111cf54d" id="r_a6e13c5fb0a17675cbe2bf781111cf54d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e13c5fb0a17675cbe2bf781111cf54d">checkSavedToken</a> ()</td></tr>
<tr class="memdesc:a6e13c5fb0a17675cbe2bf781111cf54d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for a saved JWT token and loads it if available.  <br /></td></tr>
<tr class="separator:a6e13c5fb0a17675cbe2bf781111cf54d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ac16bef3e75e3c1e3458540af65b3689d" id="r_ac16bef3e75e3c1e3458540af65b3689d"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a> [500]</td></tr>
<tr class="memdesc:ac16bef3e75e3c1e3458540af65b3689d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer for JWT token.  <br /></td></tr>
<tr class="separator:ac16bef3e75e3c1e3458540af65b3689d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2c327993ef626415d09b634e6bf286" id="r_a9f2c327993ef626415d09b634e6bf286"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a> [500]</td></tr>
<tr class="memdesc:a9f2c327993ef626415d09b634e6bf286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer for JWT token.  <br /></td></tr>
<tr class="separator:a9f2c327993ef626415d09b634e6bf286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc5cb703e43664c5a3ed6bfe23ad3d55" id="r_abc5cb703e43664c5a3ed6bfe23ad3d55"><td class="memItemLeft" align="right" valign="top"><a id="abc5cb703e43664c5a3ed6bfe23ad3d55" name="abc5cb703e43664c5a3ed6bfe23ad3d55"></a>
boolean&#160;</td><td class="memItemRight" valign="bottom"><b>gotToken</b> = false</td></tr>
<tr class="memdesc:abc5cb703e43664c5a3ed6bfe23ad3d55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether a token has been retrieved. <br /></td></tr>
<tr class="separator:abc5cb703e43664c5a3ed6bfe23ad3d55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeb0cef5f0ca2fbb543231fd2585ffd4" id="r_afeb0cef5f0ca2fbb543231fd2585ffd4"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afeb0cef5f0ca2fbb543231fd2585ffd4">jwtFilePath</a> = &quot;/jwt.txt&quot;</td></tr>
<tr class="memdesc:afeb0cef5f0ca2fbb543231fd2585ffd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path to the file storing JWT token.  <br /></td></tr>
<tr class="separator:afeb0cef5f0ca2fbb543231fd2585ffd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c713b06843f131dc88a2a09867fa3a2" id="r_a3c713b06843f131dc88a2a09867fa3a2"><td class="memItemLeft" align="right" valign="top">WiFiClient&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c713b06843f131dc88a2a09867fa3a2">client</a></td></tr>
<tr class="memdesc:a3c713b06843f131dc88a2a09867fa3a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">WiFi client object.  <br /></td></tr>
<tr class="separator:a3c713b06843f131dc88a2a09867fa3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa9b94b76dacc03be59b8d921acc198f9" name="aa9b94b76dacc03be59b8d921acc198f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9b94b76dacc03be59b8d921acc198f9">&#9670;&#160;</a></span>Authentication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Authentication::Authentication </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor for <a class="el" href="classAuthentication.html">Authentication</a> class. </p>
<p>This constructor initializes the <a class="el" href="classAuthentication.html">Authentication</a> object by clearing the jwtToken buffer. </p>
<div class="fragment"><div class="line"><span class="lineno">   24</span>{</div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">// Initialize variables</span></div>
<div class="line"><span class="lineno">   26</span>    memset(<a class="code hl_variable" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a>)); <span class="comment">// Clear jwtToken buffer</span></div>
<div class="line"><span class="lineno">   27</span>}</div>
<div class="ttc" id="aclassAuthentication_html_a9f2c327993ef626415d09b634e6bf286"><div class="ttname"><a href="#a9f2c327993ef626415d09b634e6bf286">Authentication::jwtToken</a></div><div class="ttdeci">char jwtToken[500]</div><div class="ttdoc">Buffer for JWT token.</div><div class="ttdef"><b>Definition</b> Authentication.h:33</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeb33404cd51828edf0db0cdce3c38b32" name="aeb33404cd51828edf0db0cdce3c38b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb33404cd51828edf0db0cdce3c38b32">&#9670;&#160;</a></span>authenticate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Authentication::authenticate </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authenticates the client with the server. </p>
<p>This method attempts to authenticate the client with the server by sending a POST request to the login endpoint with the provided email and password. If the authentication is successful, the JWT token received from the server is parsed and saved, and the method returns true. If any error occurs during the HTTP request or JSON parsing, or if the server returns an error response code, the method returns false.</p>
<dl class="section return"><dt>Returns</dt><dd>true if the authentication is successful, false otherwise. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  118</span>{</div>
<div class="line"><span class="lineno">  119</span>    Serial.println(<span class="stringliteral">&quot;Authenticating...&quot;</span>);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    HTTPClient http;</div>
<div class="line"><span class="lineno">  122</span>    http.begin(<a class="code hl_variable" href="#a3c713b06843f131dc88a2a09867fa3a2">client</a>, <span class="stringliteral">&quot;http://&quot;</span> + String(serverIP) + <span class="stringliteral">&quot;:&quot;</span> + String(serverPort) + <span class="stringliteral">&quot;/api/login&quot;</span>);</div>
<div class="line"><span class="lineno">  123</span>    http.addHeader(<span class="stringliteral">&quot;Content-Type&quot;</span>, <span class="stringliteral">&quot;application/json&quot;</span>);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    Serial.println(<span class="stringliteral">&quot;[HTTP] POST...&quot;</span>);</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordtype">int</span> httpCode = http.POST(<span class="stringliteral">&quot;{\&quot;email\&quot;:\&quot;&quot;</span> + String(email) + <span class="stringliteral">&quot;\&quot;,\&quot;password\&quot;:\&quot;&quot;</span> + String(passwordJwt) + <span class="stringliteral">&quot;\&quot;}&quot;</span>);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">// httpCode will be negative on error</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">if</span> (httpCode &gt; 0)</div>
<div class="line"><span class="lineno">  130</span>    {</div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">if</span> (httpCode == HTTP_CODE_OK || httpCode == HTTP_CODE_CREATED)</div>
<div class="line"><span class="lineno">  132</span>        {</div>
<div class="line"><span class="lineno">  133</span>            <span class="comment">// Parse the response JSON to get the token</span></div>
<div class="line"><span class="lineno">  134</span>            DynamicJsonDocument doc(1024);</div>
<div class="line"><span class="lineno">  135</span>            DeserializationError error = deserializeJson(doc, http.getString());</div>
<div class="line"><span class="lineno">  136</span>            <span class="keywordflow">if</span> (error)</div>
<div class="line"><span class="lineno">  137</span>            {</div>
<div class="line"><span class="lineno">  138</span>                Serial.println(<span class="stringliteral">&quot;Failed to parse JSON.&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  140</span>            }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>            strcpy(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>, doc[<span class="stringliteral">&quot;token&quot;</span>]);</div>
<div class="line"><span class="lineno">  143</span>            Serial.println(<span class="stringliteral">&quot;Authentication successful.&quot;</span>);</div>
<div class="line"><span class="lineno">  144</span>            Serial.println(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>);</div>
<div class="line"><span class="lineno">  145</span>            <a class="code hl_variable" href="#abc5cb703e43664c5a3ed6bfe23ad3d55">gotToken</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  146</span>            <a class="code hl_function" href="#a7a851cf9bcfc0010ecf0d10626312d6f">saveJWTTokenToFile</a>(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>); <span class="comment">//save for next time, so we won&#39;t need to do this again. </span></div>
<div class="line"><span class="lineno">  147</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  148</span>        }</div>
<div class="line"><span class="lineno">  149</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  150</span>        {</div>
<div class="line"><span class="lineno">  151</span>            Serial.print(<span class="stringliteral">&quot;[HTTP] Error code: &quot;</span>);</div>
<div class="line"><span class="lineno">  152</span>            Serial.println(httpCode);</div>
<div class="line"><span class="lineno">  153</span>        }</div>
<div class="line"><span class="lineno">  154</span>    }</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  156</span>    {</div>
<div class="line"><span class="lineno">  157</span>        Serial.println(<span class="stringliteral">&quot;Connection failed.&quot;</span>);</div>
<div class="line"><span class="lineno">  158</span>    }</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    http.end();</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// bool isAuthenticated = true; // Simulated result</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment">// return isAuthenticated;</span></div>
<div class="line"><span class="lineno">  165</span>}</div>
<div class="ttc" id="aclassAuthentication_html_a3c713b06843f131dc88a2a09867fa3a2"><div class="ttname"><a href="#a3c713b06843f131dc88a2a09867fa3a2">Authentication::client</a></div><div class="ttdeci">WiFiClient client</div><div class="ttdoc">WiFi client object.</div><div class="ttdef"><b>Definition</b> Authentication.h:52</div></div>
<div class="ttc" id="aclassAuthentication_html_a7a851cf9bcfc0010ecf0d10626312d6f"><div class="ttname"><a href="#a7a851cf9bcfc0010ecf0d10626312d6f">Authentication::saveJWTTokenToFile</a></div><div class="ttdeci">void saveJWTTokenToFile(const char *token)</div><div class="ttdoc">Saves a JWT token to a file on LittleFS.</div><div class="ttdef"><b>Definition</b> Authentication.cpp:83</div></div>
<div class="ttc" id="aclassAuthentication_html_abc5cb703e43664c5a3ed6bfe23ad3d55"><div class="ttname"><a href="#abc5cb703e43664c5a3ed6bfe23ad3d55">Authentication::gotToken</a></div><div class="ttdeci">boolean gotToken</div><div class="ttdoc">Flag indicating whether a token has been retrieved.</div><div class="ttdef"><b>Definition</b> Authentication.h:38</div></div>
<div class="ttc" id="aclassAuthentication_html_ac16bef3e75e3c1e3458540af65b3689d"><div class="ttname"><a href="#ac16bef3e75e3c1e3458540af65b3689d">Authentication::token</a></div><div class="ttdeci">char token[500]</div><div class="ttdoc">Buffer for JWT token.</div><div class="ttdef"><b>Definition</b> Authentication.h:26</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#a3c713b06843f131dc88a2a09867fa3a2">client</a>, <a class="el" href="#abc5cb703e43664c5a3ed6bfe23ad3d55">gotToken</a>, <a class="el" href="#a7a851cf9bcfc0010ecf0d10626312d6f">saveJWTTokenToFile()</a>, and <a class="el" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>.</p>

<p class="reference">Referenced by <a class="el" href="Main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d">setup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication_aeb33404cd51828edf0db0cdce3c38b32_cgraph.png" border="0" usemap="#aclassAuthentication_aeb33404cd51828edf0db0cdce3c38b32_cgraph" alt=""/></div>
<map name="aclassAuthentication_aeb33404cd51828edf0db0cdce3c38b32_cgraph" id="aclassAuthentication_aeb33404cd51828edf0db0cdce3c38b32_cgraph">
<area shape="rect" title="Authenticates the client with the server." alt="" coords="5,14,212,42"/>
<area shape="rect" href="classAuthentication.html#a7a851cf9bcfc0010ecf0d10626312d6f" title="Saves a JWT token to a file on LittleFS." alt="" coords="260,5,477,50"/>
<area shape="poly" title=" " alt="" coords="212,25,244,25,244,30,212,30"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication_aeb33404cd51828edf0db0cdce3c38b32_icgraph.png" border="0" usemap="#aclassAuthentication_aeb33404cd51828edf0db0cdce3c38b32_icgraph" alt=""/></div>
<map name="aclassAuthentication_aeb33404cd51828edf0db0cdce3c38b32_icgraph" id="aclassAuthentication_aeb33404cd51828edf0db0cdce3c38b32_icgraph">
<area shape="rect" title="Authenticates the client with the server." alt="" coords="111,5,317,33"/>
<area shape="rect" href="Main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Sets up the system including WiFi connection, authentication, and loading and playing timeline data." alt="" coords="5,5,63,33"/>
<area shape="poly" title=" " alt="" coords="95,22,63,22,63,17,95,17"/>
</map>
</div>

</div>
</div>
<a id="a6e13c5fb0a17675cbe2bf781111cf54d" name="a6e13c5fb0a17675cbe2bf781111cf54d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e13c5fb0a17675cbe2bf781111cf54d">&#9670;&#160;</a></span>checkSavedToken()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Authentication::checkSavedToken </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks for a saved JWT token and loads it if available. </p>
<p>This method checks if a JWT token is saved in a file. If a token is found, it loads the token into the internal token buffer. If no token is found, the method returns false.</p>
<dl class="section return"><dt>Returns</dt><dd>true if a saved token is successfully loaded, false otherwise. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  178</span>{</div>
<div class="line"><span class="lineno">  179</span>    <span class="comment">// check for saved token, load</span></div>
<div class="line"><span class="lineno">  180</span>    String savedToken = <a class="code hl_function" href="#ac67cb64472ed5e95794d07ce9f5e1b86">readJWTTokenFromFile</a>();</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">if</span> (!savedToken.isEmpty())</div>
<div class="line"><span class="lineno">  182</span>    {</div>
<div class="line"><span class="lineno">  183</span>        strncpy(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>, savedToken.c_str(), <span class="keyword">sizeof</span>(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>) - 1);</div>
<div class="line"><span class="lineno">  184</span>        <a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>[<span class="keyword">sizeof</span>(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>) - 1] = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">// Null-terminate the token string</span></div>
<div class="line"><span class="lineno">  185</span>        <span class="comment">// strncpy(jwtToken, savedToken.c_str(), sizeof(jwtToken) - 1);</span></div>
<div class="line"><span class="lineno">  186</span>        <span class="comment">// jwtToken[sizeof(jwtToken) - 1] = &#39;\0&#39;; // Null-terminate the token string</span></div>
<div class="line"><span class="lineno">  187</span>        <a class="code hl_variable" href="#abc5cb703e43664c5a3ed6bfe23ad3d55">gotToken</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  188</span>        Serial.println(<span class="stringliteral">&quot;Using saved JWT token:&quot;</span>);</div>
<div class="line"><span class="lineno">  189</span>        Serial.println(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>);</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  191</span>    }</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  193</span>    {</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  195</span>    }</div>
<div class="line"><span class="lineno">  196</span>}</div>
<div class="ttc" id="aclassAuthentication_html_ac67cb64472ed5e95794d07ce9f5e1b86"><div class="ttname"><a href="#ac67cb64472ed5e95794d07ce9f5e1b86">Authentication::readJWTTokenFromFile</a></div><div class="ttdeci">String readJWTTokenFromFile()</div><div class="ttdoc">Reads JWT token from a file stored on LittleFS.</div><div class="ttdef"><b>Definition</b> Authentication.cpp:39</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#abc5cb703e43664c5a3ed6bfe23ad3d55">gotToken</a>, <a class="el" href="#ac67cb64472ed5e95794d07ce9f5e1b86">readJWTTokenFromFile()</a>, and <a class="el" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>.</p>

<p class="reference">Referenced by <a class="el" href="Main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d">setup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_cgraph.png" border="0" usemap="#aclassAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_cgraph" alt=""/></div>
<map name="aclassAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_cgraph" id="aclassAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_cgraph">
<area shape="rect" title="Checks for a saved JWT token and loads it if available." alt="" coords="5,5,208,50"/>
<area shape="rect" href="classAuthentication.html#ac67cb64472ed5e95794d07ce9f5e1b86" title="Reads JWT token from a file stored on LittleFS." alt="" coords="256,5,471,50"/>
<area shape="poly" title=" " alt="" coords="208,25,240,25,240,30,208,30"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_icgraph.png" border="0" usemap="#aclassAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_icgraph" alt=""/></div>
<map name="aclassAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_icgraph" id="aclassAuthentication_a6e13c5fb0a17675cbe2bf781111cf54d_icgraph">
<area shape="rect" title="Checks for a saved JWT token and loads it if available." alt="" coords="111,5,313,50"/>
<area shape="rect" href="Main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Sets up the system including WiFi connection, authentication, and loading and playing timeline data." alt="" coords="5,14,63,42"/>
<area shape="poly" title=" " alt="" coords="95,30,63,30,63,25,95,25"/>
</map>
</div>

</div>
</div>
<a id="ac67cb64472ed5e95794d07ce9f5e1b86" name="ac67cb64472ed5e95794d07ce9f5e1b86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac67cb64472ed5e95794d07ce9f5e1b86">&#9670;&#160;</a></span>readJWTTokenFromFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String Authentication::readJWTTokenFromFile </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads JWT token from a file stored on LittleFS. </p>
<p>This method attempts to read a JWT token from a file stored on LittleFS (Little File System). If the file exists, it reads the token from the file and returns it. If the file does not exist or if there's any failure during the file system operation, an empty string is returned.</p>
<dl class="section return"><dt>Returns</dt><dd>A string containing the JWT token read from the file, or an empty string if the token couldn't be read. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   40</span>{</div>
<div class="line"><span class="lineno">   41</span>    String <a class="code hl_variable" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">if</span> (LittleFS.begin())</div>
<div class="line"><span class="lineno">   44</span>    {</div>
<div class="line"><span class="lineno">   45</span>        <span class="keywordflow">if</span> (LittleFS.exists(<a class="code hl_variable" href="#afeb0cef5f0ca2fbb543231fd2585ffd4">jwtFilePath</a>))</div>
<div class="line"><span class="lineno">   46</span>        {</div>
<div class="line"><span class="lineno">   47</span>            File file = LittleFS.open(<a class="code hl_variable" href="#afeb0cef5f0ca2fbb543231fd2585ffd4">jwtFilePath</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">   48</span>            <span class="keywordflow">if</span> (file)</div>
<div class="line"><span class="lineno">   49</span>            {</div>
<div class="line"><span class="lineno">   50</span>                <a class="code hl_variable" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a> = file.readString();</div>
<div class="line"><span class="lineno">   51</span>                file.close();</div>
<div class="line"><span class="lineno">   52</span>            }</div>
<div class="line"><span class="lineno">   53</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   54</span>            {</div>
<div class="line"><span class="lineno">   55</span>                Serial.println(<span class="stringliteral">&quot;no file?&quot;</span>);</div>
<div class="line"><span class="lineno">   56</span>            }</div>
<div class="line"><span class="lineno">   57</span>        }</div>
<div class="line"><span class="lineno">   58</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   59</span>        {</div>
<div class="line"><span class="lineno">   60</span>            Serial.println(<span class="stringliteral">&quot;file not found on LittleFS&quot;</span>);</div>
<div class="line"><span class="lineno">   61</span>        }</div>
<div class="line"><span class="lineno">   62</span>        LittleFS.end();</div>
<div class="line"><span class="lineno">   63</span>    }</div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   65</span>    {</div>
<div class="line"><span class="lineno">   66</span>        Serial.println(<span class="stringliteral">&quot;LittlFS Failed to begin&quot;</span>);</div>
<div class="line"><span class="lineno">   67</span>    }</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a>;</div>
<div class="line"><span class="lineno">   70</span>}</div>
<div class="ttc" id="aclassAuthentication_html_afeb0cef5f0ca2fbb543231fd2585ffd4"><div class="ttname"><a href="#afeb0cef5f0ca2fbb543231fd2585ffd4">Authentication::jwtFilePath</a></div><div class="ttdeci">const char * jwtFilePath</div><div class="ttdoc">Path to the file storing JWT token.</div><div class="ttdef"><b>Definition</b> Authentication.h:45</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#afeb0cef5f0ca2fbb543231fd2585ffd4">jwtFilePath</a>, and <a class="el" href="#a9f2c327993ef626415d09b634e6bf286">jwtToken</a>.</p>

<p class="reference">Referenced by <a class="el" href="#a6e13c5fb0a17675cbe2bf781111cf54d">checkSavedToken()</a>, and <a class="el" href="classLoading.html#a7634c001ec052e10c402e49f5be030db">Loading::Loading()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication_ac67cb64472ed5e95794d07ce9f5e1b86_icgraph.png" border="0" usemap="#aclassAuthentication_ac67cb64472ed5e95794d07ce9f5e1b86_icgraph" alt=""/></div>
<map name="aclassAuthentication_ac67cb64472ed5e95794d07ce9f5e1b86_icgraph" id="aclassAuthentication_ac67cb64472ed5e95794d07ce9f5e1b86_icgraph">
<area shape="rect" title="Reads JWT token from a file stored on LittleFS." alt="" coords="361,36,576,81"/>
<area shape="rect" href="classAuthentication.html#a6e13c5fb0a17675cbe2bf781111cf54d" title="Checks for a saved JWT token and loads it if available." alt="" coords="111,5,313,50"/>
<area shape="poly" title=" " alt="" coords="345,46,313,42,314,37,346,41"/>
<area shape="rect" href="classLoading.html#a7634c001ec052e10c402e49f5be030db" title="Default constructor for Loading class." alt="" coords="146,74,278,102"/>
<area shape="poly" title=" " alt="" coords="346,75,278,83,278,78,346,70"/>
<area shape="rect" href="Main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Sets up the system including WiFi connection, authentication, and loading and playing timeline data." alt="" coords="5,14,63,42"/>
<area shape="poly" title=" " alt="" coords="95,30,63,30,63,25,95,25"/>
</map>
</div>

</div>
</div>
<a id="a7a851cf9bcfc0010ecf0d10626312d6f" name="a7a851cf9bcfc0010ecf0d10626312d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a851cf9bcfc0010ecf0d10626312d6f">&#9670;&#160;</a></span>saveJWTTokenToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Authentication::saveJWTTokenToFile </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>token</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves a JWT token to a file on LittleFS. </p>
<p>This method attempts to save a JWT token to a file stored on LittleFS (Little File System). If LittleFS initialization succeeds and the file is successfully created and written, a success message is printed to the Serial monitor. If there's any failure during the file system operation, an error message is printed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>The JWT token to be saved to the file. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   84</span>{</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (LittleFS.begin())</div>
<div class="line"><span class="lineno">   86</span>    {</div>
<div class="line"><span class="lineno">   87</span>        File file = LittleFS.open(<a class="code hl_variable" href="#afeb0cef5f0ca2fbb543231fd2585ffd4">jwtFilePath</a>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">if</span> (file)</div>
<div class="line"><span class="lineno">   89</span>        {</div>
<div class="line"><span class="lineno">   90</span>            file.print(<a class="code hl_variable" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>);</div>
<div class="line"><span class="lineno">   91</span>            file.close();</div>
<div class="line"><span class="lineno">   92</span>            Serial.println(<span class="stringliteral">&quot;JWT token saved to file.&quot;</span>);</div>
<div class="line"><span class="lineno">   93</span>        }</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   95</span>        {</div>
<div class="line"><span class="lineno">   96</span>            Serial.println(<span class="stringliteral">&quot;couldn&#39;t create file?&quot;</span>);</div>
<div class="line"><span class="lineno">   97</span>        }</div>
<div class="line"><span class="lineno">   98</span>        LittleFS.end();</div>
<div class="line"><span class="lineno">   99</span>    }</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  101</span>        Serial.println(<span class="stringliteral">&quot;Couldn&#39;t open Littlefs to write jwt&quot;</span>);</div>
<div class="line"><span class="lineno">  102</span>    }</div>
<div class="line"><span class="lineno">  103</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#afeb0cef5f0ca2fbb543231fd2585ffd4">jwtFilePath</a>, and <a class="el" href="#ac16bef3e75e3c1e3458540af65b3689d">token</a>.</p>

<p class="reference">Referenced by <a class="el" href="#aeb33404cd51828edf0db0cdce3c38b32">authenticate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthentication_a7a851cf9bcfc0010ecf0d10626312d6f_icgraph.png" border="0" usemap="#aclassAuthentication_a7a851cf9bcfc0010ecf0d10626312d6f_icgraph" alt=""/></div>
<map name="aclassAuthentication_a7a851cf9bcfc0010ecf0d10626312d6f_icgraph" id="aclassAuthentication_a7a851cf9bcfc0010ecf0d10626312d6f_icgraph">
<area shape="rect" title="Saves a JWT token to a file on LittleFS." alt="" coords="365,5,582,50"/>
<area shape="rect" href="classAuthentication.html#aeb33404cd51828edf0db0cdce3c38b32" title="Authenticates the client with the server." alt="" coords="111,14,317,42"/>
<area shape="poly" title=" " alt="" coords="349,30,317,30,317,25,349,25"/>
<area shape="rect" href="Main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Sets up the system including WiFi connection, authentication, and loading and playing timeline data." alt="" coords="5,14,63,42"/>
<area shape="poly" title=" " alt="" coords="95,30,63,30,63,25,95,25"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3c713b06843f131dc88a2a09867fa3a2" name="a3c713b06843f131dc88a2a09867fa3a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c713b06843f131dc88a2a09867fa3a2">&#9670;&#160;</a></span>client</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">WiFiClient Authentication::client</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>WiFi client object. </p>
<p>This object is used for network communication with the server. </p>

<p class="reference">Referenced by <a class="el" href="#aeb33404cd51828edf0db0cdce3c38b32">authenticate()</a>.</p>

</div>
</div>
<a id="afeb0cef5f0ca2fbb543231fd2585ffd4" name="afeb0cef5f0ca2fbb543231fd2585ffd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb0cef5f0ca2fbb543231fd2585ffd4">&#9670;&#160;</a></span>jwtFilePath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* Authentication::jwtFilePath = &quot;/jwt.txt&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Path to the file storing JWT token. </p>
<p>This string represents the file path of the file storing the JWT token in LittleFS. </p>

<p class="reference">Referenced by <a class="el" href="#ac67cb64472ed5e95794d07ce9f5e1b86">readJWTTokenFromFile()</a>, and <a class="el" href="#a7a851cf9bcfc0010ecf0d10626312d6f">saveJWTTokenToFile()</a>.</p>

</div>
</div>
<a id="a9f2c327993ef626415d09b634e6bf286" name="a9f2c327993ef626415d09b634e6bf286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f2c327993ef626415d09b634e6bf286">&#9670;&#160;</a></span>jwtToken</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char Authentication::jwtToken[500]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer for JWT token. </p>
<p>This buffer stores the JWT token retrieved from LittleFS. </p>

<p class="reference">Referenced by <a class="el" href="#aa9b94b76dacc03be59b8d921acc198f9">Authentication()</a>, and <a class="el" href="#ac67cb64472ed5e95794d07ce9f5e1b86">readJWTTokenFromFile()</a>.</p>

</div>
</div>
<a id="ac16bef3e75e3c1e3458540af65b3689d" name="ac16bef3e75e3c1e3458540af65b3689d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac16bef3e75e3c1e3458540af65b3689d">&#9670;&#160;</a></span>token</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char Authentication::token[500]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer for JWT token. </p>
<p>This buffer stores the JWT token retrieved from authentication. </p>

<p class="reference">Referenced by <a class="el" href="#aeb33404cd51828edf0db0cdce3c38b32">authenticate()</a>, <a class="el" href="#a6e13c5fb0a17675cbe2bf781111cf54d">checkSavedToken()</a>, and <a class="el" href="#a7a851cf9bcfc0010ecf0d10626312d6f">saveJWTTokenToFile()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="Authentication_8h_source.html">Authentication.h</a></li>
<li>src/<a class="el" href="Authentication_8cpp.html">Authentication.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
